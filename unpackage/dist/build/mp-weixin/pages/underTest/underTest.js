(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/underTest/underTest"],{"0232":function(t,e,n){},"1e05":function(t,e,n){"use strict";var o=n("0232"),a=n.n(o);a.a},5159:function(t,e,n){"use strict";(function(t){n("36fd");o(n("66fd"));var e=o(n("87fb"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"6a38":function(t,e,n){"use strict";n.r(e);var o=n("7ddb"),a=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(e,t,(function(){return o[t]}))}(s);e["default"]=a.a},"7ddb":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=s(n("8d5f"));function a(){if("function"!==typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function s(t){if(t&&t.__esModule)return t;if(null===t||"object"!==typeof t&&"function"!==typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var i=o?Object.getOwnPropertyDescriptor(t,s):null;i&&(i.get||i.set)?Object.defineProperty(n,s,i):n[s]=t[s]}return n.default=t,e&&e.set(t,n),n}var i=function(){Promise.all([n.e("common/vendor"),n.e("node-modules/mpvue-echarts/src/echarts")]).then(function(){return resolve(n("89ce"))}.bind(null,n)).catch(n.oe)},r={components:{mpvueEcharts:i},data:function(){return{showStatisti:!1,echarts:o,TestingInfo:{},TestingLogId:"",StudentList:[],topicArr:[],RightRateList:[]}},methods:{CloseStatisti:function(){this.$data.showStatisti=!1},onShowStatisti:function(){this.$data.showStatisti=!0},StatiChart:function(t){var e=t.canvas,n=t.width,a=t.height;n-=20,o.setCanvasCreator((function(){return e}));var s=o.init(e,null,{width:n,height:a});e.setChart(s);var i={color:["#03C173"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"1%",right:"1%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:[3,5,8,65,43],axisTick:{show:!1},axisLine:{show:!1},splitLine:{show:!1}}],yAxis:[{show:!1,type:"value",axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}}],series:[{name:"",type:"bar",barWidth:"60%",data:[10,52,20,34,39,30,20],itemStyle:{normal:{label:{formatter:"{c}%",show:!0,position:"top",textStyle:{fontWeight:"bolder",fontSize:"12",color:"#929CA4"}}}}}]};s.setOption(i),s.setOption({xAxis:[{data:["A","B","C","D","E"]}],series:[{data:[12,3,43,54,65],itemStyle:{normal:{label:{formatter:"{c}%",show:!0,position:"top",textStyle:{fontWeight:"bolder",fontSize:"12",color:"#929CA4"}}}}}]}),this.$refs.statistiChart.setChart(s)},GetAnswerStatistics:function(){var e=this;t.request({method:"GET",url:"https://hk.joyfulboo.com/Campus/TestingApp/GetAnswerStatistics",data:{testingLogId:this.$data.TestingLogId},header:{"content-type":"application/json",Authorization:t.getStorageSync("token")},success:function(n){console.log(n);var o=n.data;if(1!=o.Success)return t.showToast({title:o.Message,icon:"none"}),!1;var a=o.Data;for(var s in a){var i=a[s];e.$data.topicArr.push(i.Name),e.$data.RightRateList.push(i.RightRate),console.log(e.$data.topicArr)}e.$refs.FailChart.init()}})},SaveTestingEnd:function(e){var n=this,o=n.$data.TestingInfo.TestPaperType,a="";1==e?(a="确定要结束测试吗？",o=2):(a="确定要取消测试吗？",o=3),wx.showModal({title:"提示",content:a,success:function(a){a.confirm?t.request({method:"POST",url:"https://hk.joyfulboo.com/Campus/TestingApp/SaveTestingEnd",data:{TestingLogId:n.$data.TestingLogId,TestingStatus:o},header:{"content-type":"application/json",Authorization:t.getStorageSync("token")},success:function(o){console.log(o);var a=o.data;if(1!=a.Success)return t.showToast({title:a.Message,icon:"none"}),!1;t.showToast({title:"取消成功",icon:"none"}),1==e?setTimeout((function(){wx.navigateTo({url:"../testDetails/testDetails?TestingLogId="+n.$data.TestingLogId})}),1e3):setTimeout((function(){wx.navigateBack({delta:1})}),1e3)}}):a.cancel&&console.log("用户点击取消")}})},GetTestingStatusList:function(){var e=this;t.request({method:"GET",data:{testingLogId:e.$data.TestingLogId},url:"https://hk.joyfulboo.com/Campus/TestingApp/GetTestingStatusList",header:{"content-type":"application/json",Authorization:t.getStorageSync("token")},success:function(n){console.log(n);var o=n.data;if(1!=o.Success)return t.showToast({title:Res.Message,icon:"none"}),!1;e.$data.TestingInfo=o.Data,e.$data.StudentList=o.Data.StudentList}})},callMethods:function(t){switch(t.M[0].M){case"pong":console.log("Pong防止nginx中断连接");break;case"xcxMessage":console.log(t.M[0].A[0]);var e=t.M[0].A[0];9==e.MessageType?this.GetTestingStatusList():8==e.MessageType&&this.GetAnswerStatistics();break;default:console.log(t)}}},onLoad:function(t){var e=this;this.$data.TestingLogId=t.TestingLogId,this.GetTestingStatusList(),this.GetAnswerStatistics(),wx.onSocketMessage((function(t){try{var n=String(t.data).replace(recordString,"");if(n.indexOf("{}")>-1&&(n=n.replace("{}","")),0!=n.length){var o=JSON.parse(n);console.log("server return :",o),"M"in o&&o.M.length>0&&e.callMethods(o)}}catch(a){console.log("异常："+a),console.log("收到服务器内容："+t.data)}}))}};e.default=r}).call(this,n("543d")["default"])},"87fb":function(t,e,n){"use strict";n.r(e);var o=n("b7f6"),a=n("6a38");for(var s in a)"default"!==s&&function(t){n.d(e,t,(function(){return a[t]}))}(s);n("1e05");var i,r=n("f0c5"),c=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"6aa30010",null,!1,o["a"],i);e["default"]=c.exports},b7f6:function(t,e,n){"use strict";var o,a=function(){var t=this,e=t.$createElement;t._self._c},s=[];n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return o}))}},[["5159","common/runtime","common/vendor"]]]);