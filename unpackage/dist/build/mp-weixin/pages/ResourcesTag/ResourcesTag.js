(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/ResourcesTag/ResourcesTag"],{"256f":function(e,t,a){},"2f65":function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){a.e("node-modules/@dcloudio/uni-ui/lib/uni-load-more/uni-load-more").then(function(){return resolve(a("5c56"))}.bind(null,a)).catch(a.oe)},n=function(){a.e("node-modules/@dcloudio/uni-ui/lib/uni-search-bar/uni-search-bar").then(function(){return resolve(a("b501"))}.bind(null,a)).catch(a.oe)},s=function(){a.e("components/DataNo").then(function(){return resolve(a("9ef9"))}.bind(null,a)).catch(a.oe)},i=a("935a"),c=(i.request,i.showLoading),u=i.hideLoading,r={components:{uniSearchBar:n,DataNo:s,uniLoadMore:o},data:function(){return{TagId:"",fileType:"",ResourcesList:[],activeEdit:null,delBtnWidth:400,startX:"",isEdit:!1,currentPage:1,pageSize:10,searchValue:"",TotalPages:"",renameName:"",resourcesType:"",ResourcesY:"",ResourcesLoad:"",onPageY:""}},methods:{onResourcesStart:function(e){1==e.touches.length&&(this.ResourcesY=e.touches[0].clientY,this.onPageY=e.touches[0].pageY)},onResourcesMove:function(e){if(console.log(e),1==e.touches.length){var t=e.touches[0].clientY,a=this.ResourcesY-t;e.touches[0].pageY;this.$data.onPageY<210&&(e.stopPropagation(),e.preventDefault(),a<-80&&!this.$data.ResourcesLoad?(this.$data.ResourcesLoad="loading",this.GetResourcesByPage()):a>310&&(this.$data.ResourcesLoad=""))}},onLoading:function(){var t=this;e.showLoading({title:"加载中",success:function(){t.GetResourcesByPage()}}),setTimeout((function(){e.hideLoading()}),2e3)},onEditTag:function(t,a){var o=this;e.navigateTo({url:"../editTag/editTag?ResourcesId=".concat(t,"&ResourcesType=").concat(a)}),setTimeout((function(){o.$data.activeEdit=null}),4e3)},goSearch:function(){this.GetResourcesByPage()},searchInput:function(e){this.$data.searchValue=e.value,""==e.value&&this.GetResourcesByPage()},RenameResources:function(){var t=this;e.request({method:"GET",url:"https://hk.joyfulboo.com/Campus/ResourcesApp/RenameResources",data:{resourcesId:t.$data.resourcesId,resourcesType:t.$data.resourcesType,renameName:t.$data.renameName},header:{"content-type":"application/json",Authorization:e.getStorageSync("token")},success:function(a){console.log(a);var o=a.data;if(1!=o.Success)return e.showToast({title:o.Message,icon:"none"}),!1;e.showToast({title:"修改成功",duration:3e3}),t.$data.isEdit=!1,t.GetResourcesByPage()}})},unhide:function(){this.$data.isEdit=!1,this.$data.activeEdit=null},onEdit:function(e,t){this.$data.resourcesType=t,this.$data.resourcesId=e,this.$data.isEdit=!0},inputVal:function(e){this.$data.renameName=e.detail.value},DeleteResources:function(t){console.log(t);var a=this;wx.showModal({title:"提示",content:"确认要删除此课件吗？",success:function(o){o.confirm?e.request({method:"GET",url:"https://hk.joyfulboo.com/Campus/ResourcesApp/DeleteResources",data:{resourcesId:t},header:{"content-type":"application/json",Authorization:e.getStorageSync("token")},success:function(t){console.log(t);var o=t.data;if(1!=o.Success)return e.showToast({title:o.Message,icon:"none"}),!1;e.showToast({title:"删除成功",duration:3e3}),a.GetResourcesByPage()}}):o.cancel&&console.log("用户点击取消")}})},OpenFile:function(t,a){var o=this;5==a?e.navigateTo({url:"../testInfo/testInfo?ResourcesId="+t}):e.request({method:"GET",url:"https://hk.joyfulboo.com/Campus/CoursewareApp/PreviewCoursewareOnline",data:{resourcesId:t,isCurrent:!1,classroomLogId:""},header:{"content-type":"application/json",Authorization:e.getStorageSync("token")},success:function(t){console.log(t);var n=t.data;if(1!=n.Success)return e.showToast({title:n.Message,icon:"none"}),!1;if(1==a)c("加载中"),wx.downloadFile({url:n.Data,success:function(e){console.log(e);var t=e.tempFilePath;wx.openDocument({filePath:t,success:function(e){u()}})}});else if(2==a){var s=[];s.push(n.Data),console.log(s),e.previewImage({urls:s,current:s[0]})}else if(3==a)e.navigateTo({url:"../videoMP/videoMP?videoSrc="+n.Data});else if(6==a){var i=JSON.stringify(n.Data);e.navigateTo({url:"../videoMP/videoMP?videoArr="+i})}else if(7==a){o.$data.playAudio=!o.$data.playAudio;var r=o.$data.playAudio;r?wx.playBackgroundAudio({dataUrl:n.Data,title:"",coverImgUrl:""}):wx.stopBackgroundAudio()}}})},GetResourcesByPage:function(){var t=this;e.request({method:"GET",url:"https://hk.joyfulboo.com/Campus/ResourcesApp/GetResourcesByPage",data:{tagId:t.$data.TagId,fileType:t.$data.fileType,currentPage:t.$data.currentPage,pageSize:t.$data.pageSize,searchValue:t.$data.searchValue},header:{"content-type":"application/json",Authorization:e.getStorageSync("token")},success:function(a){console.log(a);var o=a.data;if(1!=o.Success)return e.showToast({title:o.Message,icon:"none"}),!1;var n=Math.ceil(o.RecordCount/t.$data.pageSize);t.$data.TotalPages=n;var s=t.$data.ResourcesList,i=t.$data.currentPage;if(1==t.$data.currentPage)s=o.Data,console.log(s),i=1,e.stopPullDownRefresh();else{var c=a.data.Data;s=s.concat(c),i+=1}t.$data.activeEdit=null,t.$data.ResourcesList=s,t.$data.currentPage=i,setTimeout((function(){t.$data.ResourcesLoad=""}),2e3)}})},onPanStart:function(e){1==e.touches.length&&(this.startX=e.touches[0].clientX)},onPanMove:function(e){if(1==e.touches.length){var t=e.touches[0].clientX,a=this.startX-t,o=this.delBtnWidth,n=e.currentTarget.dataset.index;120==a||a<120?this.$data.activeEdit=null:a>120&&(this.$data.activeEdit=n,a>=o&&(this.$data.activeEdit=n))}}},onReachBottom:function(){this.$data.currentPage<this.$data.TotalPages?(this.$data.currentPage++,this.GetResourcesByPage()):console.log("没有更多数据了")},onPullDownRefresh:function(){this.$data.currentPage=1,this.GetResourcesByPage()},onLoad:function(e){e.FileType&&(this.$data.fileType=e.FileType),e.TagId&&(this.$data.TagId=e.TagId),e.searchValue&&(this.$data.searchValue=e.searchValue),this.GetResourcesByPage()}};t.default=r}).call(this,a("543d")["default"])},"95e3":function(e,t,a){"use strict";(function(e){a("36fd");o(a("66fd"));var t=o(a("a16d"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,a("543d")["createPage"])},"9ad8":function(e,t,a){"use strict";var o,n=function(){var e=this,t=e.$createElement,a=(e._self._c,{contentdown:"上拉显示更多",contentrefresh:"正在加载...",contentnomore:""});e.$mp.data=Object.assign({},{$root:{a0:a}})},s=[];a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return o}))},a16d:function(e,t,a){"use strict";a.r(t);var o=a("9ad8"),n=a("d2b8");for(var s in n)"default"!==s&&function(e){a.d(t,e,(function(){return n[e]}))}(s);a("d7d9");var i,c=a("f0c5"),u=Object(c["a"])(n["default"],o["b"],o["c"],!1,null,"7fe9b4fe",null,!1,o["a"],i);t["default"]=u.exports},d2b8:function(e,t,a){"use strict";a.r(t);var o=a("2f65"),n=a.n(o);for(var s in o)"default"!==s&&function(e){a.d(t,e,(function(){return o[e]}))}(s);t["default"]=n.a},d7d9:function(e,t,a){"use strict";var o=a("256f"),n=a.n(o);n.a}},[["95e3","common/runtime","common/vendor"]]]);